# Virtual DOM and DOM

## Whatâ€™s Virtual DOM

```jsx
<div class='app' id='appRoot'>
  <h1 class='title'>æ¬¢è¿è¿›å…¥Reactçš„ä¸–ç•Œ</h1>
  <p>
    React.js æ˜¯ä¸€ä¸ªå¸®åŠ©ä½ æ„å»ºé¡µé¢ UI çš„åº“
  </p>
</div>
```

ä¸Šé¢è¿™ä¸ª HTML æ‰€æœ‰çš„ä¿¡æ¯æˆ‘ä»¬éƒ½å¯ä»¥ç”¨ä¸€ä¸ª **JavaScript å¯¹è±¡** æ¥è¡¨ç¤ºï¼š

```jsx
{
  tag: 'div',
  attrs: { className: 'app', id: 'appRoot'},
  children: [
    {
      tag: 'h1',
      attrs: { className: 'title' },
      children: ['æ¬¢è¿è¿›å…¥Reactçš„ä¸–ç•Œ']
    },
    {
      tag: 'p',
      attrs: null,
      children: ['React.js æ˜¯ä¸€ä¸ªæ„å»ºé¡µé¢ UI çš„åº“']
    }
  ]
}
```

è¿™æ®µ JavaScript å¯¹è±¡å°±æ˜¯ è™šæ‹Ÿ DOM ã€‚

## Virtual DOM vs Real DOM

ç”¨ DOMï¼Œ åªè¦ä¿®æ”¹ä¸€ç‚¹ç‚¹ä¿¡æ¯ï¼Œå°±éœ€è¦é‡æ–°æ¸²æŸ“é¡µé¢ã€‚

ç”¨è™šæ‹Ÿ DOMï¼Œå°±å¯ä»¥ä¿®æ”¹å“ªéƒ¨åˆ†ï¼Œå®ƒåªæ¸²æŸ“å“ªéƒ¨åˆ†çš„é¡µé¢ï¼Œé€Ÿåº¦å¾ˆå¿«ã€‚

## React é«˜æ€§èƒ½çš„ä½“ç°ï¼šVirtual DOM

åœ¨ Web å¼€å‘ä¸­æˆ‘ä»¬æ€»éœ€è¦å°†å˜åŒ–çš„æ•°æ®å®æ—¶ååº”åˆ° UI ä¸Šï¼Œè¿™æ—¶å°±éœ€è¦å¯¹ DOM è¿›è¡Œæ“ä½œã€‚

å¤æ‚æˆ–é¢‘ç¹çš„ DOM æ“ä½œé€šå¸¸æ˜¯æ€§èƒ½ç“¶é¢ˆäº§ç”Ÿçš„åŸå› ã€‚

> å¦‚ä½•è¿›è¡Œé«˜æ€§èƒ½çš„å¤æ‚DOMæ“ä½œé€šå¸¸æ˜¯è¡¡é‡ä¸€ä¸ªå‰ç«¯å¼€å‘äººå‘˜æŠ€èƒ½çš„é‡è¦æŒ‡æ ‡ï¼‰ã€‚

Reactä¸ºæ­¤å¼•å…¥äº†è™šæ‹ŸDOMï¼ˆVirtual DOMï¼‰çš„æœºåˆ¶ï¼š

åœ¨æµè§ˆå™¨ç«¯ç”¨ Javascript å®ç°äº†ä¸€å¥—DOM APIã€‚

åŸºäº React è¿›è¡Œå¼€å‘æ—¶æ‰€æœ‰çš„ DOM æ„é€ éƒ½æ˜¯é€šè¿‡è™šæ‹Ÿ DOM è¿›è¡Œï¼Œæ¯å½“æ•°æ®å˜åŒ–æ—¶ï¼ŒReact éƒ½ä¼šé‡æ–°æ„å»ºæ•´ä¸ª DOM æ ‘ï¼Œç„¶å React å°†å½“å‰æ•´ä¸ª DOM æ ‘å’Œä¸Šä¸€æ¬¡çš„ DOM æ ‘è¿›è¡Œå¯¹æ¯”ï¼Œå¾—åˆ° DOM ç»“æ„çš„åŒºåˆ«ï¼Œç„¶åä»…ä»…å°†éœ€è¦å˜åŒ–çš„éƒ¨åˆ†è¿›è¡Œå®é™…çš„æµè§ˆå™¨ DOM æ›´æ–°ã€‚

è€Œä¸”ï¼ŒReact èƒ½å¤Ÿæ‰¹å¤„ç†è™šæ‹Ÿ DOM çš„åˆ·æ–°ï¼Œåœ¨ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰å†…çš„ä¸¤æ¬¡æ•°æ®å˜åŒ–ä¼šè¢«åˆå¹¶ã€‚

ä¾‹å¦‚ï¼Œä½ è¿ç»­çš„å…ˆå°†èŠ‚ç‚¹å†…å®¹ä» A->B, B->Aï¼ŒReact ä¼šè®¤ä¸º A å˜æˆ Bï¼Œç„¶ååˆä» B å˜æˆ Aï¼ŒUI ä¸å‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œè€Œå¦‚æœé€šè¿‡æ‰‹åŠ¨æ§åˆ¶ï¼Œè¿™ç§é€»è¾‘é€šå¸¸æ˜¯æå…¶å¤æ‚çš„ã€‚

å°½ç®¡æ¯ä¸€æ¬¡éƒ½éœ€è¦æ„é€ å®Œæ•´çš„è™šæ‹Ÿ DOM æ ‘ï¼Œä½†æ˜¯å› ä¸º **è™šæ‹Ÿ DOM æ˜¯å†…å­˜æ•°æ®ï¼Œæ€§èƒ½æ˜¯æé«˜çš„**ï¼Œè€Œå¯¹å®é™… DOM è¿›è¡Œæ“ä½œçš„ä»…ä»…æ˜¯ Diff éƒ¨åˆ†ï¼Œå› è€Œèƒ½è¾¾åˆ°æé«˜æ€§èƒ½çš„ç›®çš„ã€‚

è¿™æ ·ï¼Œåœ¨ä¿è¯æ€§èƒ½çš„åŒæ—¶ï¼Œå¼€å‘è€…å°†ä¸å†éœ€è¦å…³æ³¨æŸä¸ªæ•°æ®çš„å˜åŒ–å¦‚ä½•æ›´æ–°åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå…·ä½“çš„ DOM å…ƒç´ ï¼Œè€Œåªéœ€è¦å…³å¿ƒåœ¨ä»»æ„ä¸€ä¸ªæ•°æ®çŠ¶æ€ä¸‹ï¼Œæ•´ä¸ªç•Œé¢æ˜¯å¦‚ä½• Render çš„ã€‚

## JSX

ä½†æ˜¯æŒ‰ JavaScript å¯¹è±¡è¿™æ ·å†™ï¼Œå¤ªé•¿ä¸”ä¸ç›´è§‚ï¼Œäºæ˜¯ React ä¸ºäº†å…¼é¡¾ä¸¤è€…ï¼Œå°±å‘æ˜äº† JSX è¯­æ³•ç³–ã€‚

```jsx
import React from 'react'
import ReactDOM from 'react-dom'

class App extends React.Component {
  render () {
    return (
      <div className='app' id='appRoot'>
        <h1 className='title'>æ¬¢è¿è¿›å…¥Reactçš„ä¸–ç•Œ</h1>
        <p>
          React.js æ˜¯ä¸€ä¸ªæ„å»ºé¡µé¢ UI çš„åº“
        </p>
      </div>
    )
  }
}

ReactDOM.render(
	<App />,
  document.getElementById('root')
)
```

ç¼–è¯‘çš„è¿‡ç¨‹ä¼šæŠŠå·¦è¾¹ç±»ä¼¼ HTML çš„ JSX ç»“æ„è½¬æ¢æˆğŸ‘‡ğŸ»çš„ JavaScript çš„å¯¹è±¡ç»“æ„ï¼Œ

ä½†å¹¶ä¸æ˜¯ç®€å•çš„ JavaScript ä»£ç æè¿°ï¼Œè€Œæ˜¯æœ‰æ–¹æ³•è°ƒç”¨ã€‚

```jsx
import React from 'react'
import ReactDOM from 'react-dom'

class App extends React.Component {
  render () {
    return (
      React.createElement(
        "div",
        {
          className: 'app',
          id: 'appRoot'
        },
        React.createElement(
          "h1",
          { className: 'title' },
          "æ¬¢è¿è¿›å…¥Reactçš„ä¸–ç•Œ"
        ),
        React.createElement(
          "p",
          null,
          "React.js æ˜¯ä¸€ä¸ªæ„å»ºé¡µé¢ UI çš„åº“"
        )
      )
    )
  }
}

ReactDOM.render(
	React.createElement(App),
  document.getElementById('root')
)
```